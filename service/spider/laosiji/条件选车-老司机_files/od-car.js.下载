(function(global) {
	function OdCar() {
		//品牌列表数据
		var OdBrandDataList;
		var brandArr = [];
		// Od.Ajax({
		// 	method: 'post', //方法
		// 	url: '/api/car/brandlist', //接口地址
		// 	asyc: true, //是否为异步
		// 	before: function() {},
		// 	success: function(data) {
		// 		console.log(JSON.stringify(data))
		// 		OdBrandDataList = data.body.brand.list;
		// 		for (var i = 0, len = OdBrandDataList.length; i < len; i++) {
		// 			brandArr.push({
		// 				'id': OdBrandDataList[i].id,
		// 				'name': OdBrandDataList[i].name,
		// 				'letter': OdBrandDataList[i].abc
		// 			});
		// 		}
		// 	}
		// });
		Od.Ajax({
			method: 'get', //方法
			url: '/Od-Car-API/lib/brand.json', //接口地址
			asyc: true, //是否为异步
			before: function() {},
			success: function(data) {
				OdBrandDataList = data.body.brand.list;
				for (var i = 0, len = OdBrandDataList.length; i < len; i++) {
					brandArr.push({
						'id': OdBrandDataList[i].id,
						'name': OdBrandDataList[i].name,
						'letter': OdBrandDataList[i].abc
					});
				}
			}
		});
		//找车-条件
		var conditionParamArr, postFixUr, maxH, minH;
		this.Condition = function(res) {
			var allConditionData = [];
			var urlReg = /(cars\/)(.*)([0-9]\/)/;
			var windowUrl = window.location.href;
			postFixUrl = windowUrl.replace(urlReg, '');
			var conditionParam;
			if (windowUrl.match(urlReg)) {
				conditionParam = windowUrl.match(urlReg)[0];
				conditionParam = conditionParam.replace(/\//g, '');
				conditionParam = conditionParam.replace(/cars/g, '');
				conditionParamArr = conditionParam.split('-');
			} else {
				conditionParamArr = [];
			}
			if (conditionParamArr.length != 13) {
				conditionParamArr = [];
				conditionParam = '';
				for (var i = 0; i < 13; i++) {
					if (i == 0) {
						conditionParam = '0';
					} else {
						conditionParam = conditionParam + '-0';
					}

				}
				window.location.href = postFixUrl + 'cars/' + conditionParam + '/';
			}
			var that = this.Condition;
			var minInput = document.getElementById('minInput');
			var maxInput = document.getElementById('maxInput');
			var submitPriceBtn = document.getElementById('submitPriceBtn');

			function toPrice() {
				var minPrice = parseInt(minInput.value);
				var maxPrice = parseInt(maxInput.value);
				if (minPrice >= 0 && maxPrice >= 0 && maxPrice > minPrice) {
					OdCar.HrefUrl((minInput.value + '_' + maxInput.value), 0, 1);
				} else {
					var text;
					var callBack;
					if (minPrice < 0 || !minPrice) {
						Od.Alert({
							html: '请输入最低价格',
							cancelBtn: false,
							callBack: function() {
								minInput.focus();
							}
						});
						return;
					}
					if (maxPrice < 0 || !maxPrice) {
						Od.Alert({
							html: '请输入最高价格',
							cancelBtn: false,
							callBack: function() {
								maxInput.focus();
							}
						});
						return;
					}
					if (maxPrice <= minPrice) {
						Od.Alert({
							html: '最高价格必须大于最低价格',
							cancelBtn: false,
							callBack: function() {
								maxInput.focus();
							}
						});
						return;
					}
				}
			};
			submitPriceBtn.onclick = function() {
				toPrice();
			};
			minInput.onkeyup = function(e) {
				e = e || event || window.event;
				if (e && e.keyCode == 13) {
					toPrice();
				}
			};
			maxInput.onkeyup = function(e) {
				e = e || event || window.event;
				if (e && e.keyCode == 13) {
					toPrice();
				}
			};
			var folderBtn = document.querySelector('.folderBtn');
			var tableList = document.querySelectorAll('.OdCarCondition');
			maxH = document.querySelector('.conditionLabelBox').offsetHeight;
			for (var i = 0, len = tableList.length; i < len; i++) {
				maxH = maxH + tableList[i].offsetHeight;
			}
			minH = 0;
			// if (document.cookie.indexOf('conditionFolder=1') >= 0) {
			// 	document.querySelector('.OdCarConditionContainer').style.height = minH + 'px';
			// 	document.getElementById('conditionFolderBtn').innerHTML = '<i></i><em>点击展开所有条件</em>';
			// 	document.getElementById('conditionFolderBtn').className = 'folderBtn';
			// } else {
			// 	document.querySelector('.OdCarConditionContainer').style.height = maxH + 10 + 'px';
			// 	document.getElementById('conditionFolderBtn').innerHTML = '<i></i><em>点击收起所有条件</em>';
			// 	document.getElementById('conditionFolderBtn').className = 'folderBtn active';
			// }
			document.getElementById('conditionFolderBtn').onclick = function() {
				if (this.className == 'folderBtn active') {
					OdCar.Folder(this, true, true);
				} else {
					OdCar.Folder(this, true, false);
				}

			};
			var smallCateBtns = document.querySelectorAll('.small-cate-btn');
			for (var i = 0, len = smallCateBtns.length; i < len; i++) {
				smallCateBtns[i].onclick = function(e) {
					var smallCateInputs = this.parentNode.parentNode.getElementsByTagName('input');
					var thisBigCode = this.parentNode.parentNode.parentNode.parentNode.getAttribute('data-code');
					thisParamArr = conditionParamArr[parseInt(this.getAttribute('data-sort'))];
					thisParamArr = thisParamArr.split('_');
					var thisParamArrFinal = [];
					for (var k = 0, leng = smallCateInputs.length; k < leng; k++) {
						var thisVal = smallCateInputs[k].getAttribute('data-code');
						if (smallCateInputs[k].checked) {
							thisParamArrFinal.push(thisVal);
							if (k == 0) {
								break;
							}
						}
					}
					for (var j = 0, lenn = thisParamArr.length; j < lenn; j++) {
						var num = thisParamArr[j].substr(0, 1);

						if (thisParamArrFinal.indexOf(thisParamArr[j]) < 0 && thisParamArr[j] != thisBigCode && thisParamArrFinal.indexOf(num) < 0 && thisParamArr[j] != '0') {
							thisParamArrFinal.push(thisParamArr[j]);
						}
					}
					var codes = '';
					if (thisParamArrFinal.length > 1) {
						for (var m = 0, lenm = thisParamArrFinal.length; m < lenm; m++) {
							codes = codes + '_' + thisParamArrFinal[m];
						}
						codes = codes.replace('_', '');
					} else {
						codes = thisParamArrFinal[0];
					}

					if (conditionParamArr[parseInt(this.getAttribute('data-sort'))] == codes) {
						return;
					} else {
						OdCar.HrefUrl(codes, parseInt(this.getAttribute('data-sort')), 3);
					}
				}
			}
		};
		//找车-折叠条件
		this.Folder = function(dom, handle, isFolder) {
			var conditionFolderExpdate = new Date(); //初始化时间
			conditionFolderExpdate.setTime(conditionFolderExpdate.getTime() + 1000 * 60 * 60 * 24 * 182); //一年有效
			if (isFolder) {
				// if (handle) {
				// 	document.cookie = 'conditionFolder=1;expires=' + conditionFolderExpdate.toGMTString() + ';path=/';
				// }
				document.querySelector('.OdCarConditionContainer').style.height = minH + 'px';
				dom.innerHTML = '<i></i><em>更改筛选条件</em>';
				dom.className = 'folderBtn';
			} else {
				// if (handle) {
				// document.cookie = 'conditionFolder=0;expires=' + conditionFolderExpdate.toGMTString() + ';path=/';
				// }
				// if (handle || document.cookie.indexOf('conditionFolder=1') < 0) {
				document.querySelector('.OdCarConditionContainer').style.height = maxH + 10 + 'px';
				dom.innerHTML = '<i></i><em>收起筛选条件</em>';
				dom.className = 'folderBtn active';
				// }
			}

		};
		//找车-checkbox全选
		this.CheckBox = function(dom) {
			var inputs = [];
			for (var i = 0, len = document.getElementsByTagName('input').length; i < len; i++) {
				if (document.getElementsByTagName('input')[i].getAttribute('type') == 'checkbox' && document.getElementsByTagName('input')[i].getAttribute('checkall') && document.getElementsByTagName('input')[i].getAttribute('checkname') && document.getElementsByTagName('input')[i].getAttribute('checkname') == dom.getAttribute('checkname')) {
					inputs.push(document.getElementsByTagName('input')[i]);
				}
			}
			for (var i = 0, len = inputs.length; i < len; i++) {
				if (dom === inputs[i]) {
					if (i == 0) {
						for (var j = 0, lenn = inputs.length; j < lenn; j++) {
							if (dom.checked == true) {
								inputs[j].checked = true;
							} else {
								inputs[j].checked = false;
							}
						}
					} else {
						if (!dom.checked) {
							inputs[0].checked = false;
						} else {
							var flag = true;
							for (var k = 1, leng = inputs.length; k < leng; k++) {
								if (!inputs[k].checked) {
									flag = false;
									break;
								}
							}
							if (flag) {
								inputs[0].checked = true;
							}
						}
					}
				}
			}
		};
		//找车-条件按钮选车跳转url单选
		this.HrefUrl = function(data, index, isAdd) {
			url = '';
			data = data ? data.toString() : '';
			var thisArr = [];
			for (var i = 0, len = conditionParamArr.length; i < len; i++) {
				var item = '';
				if (i == index) {
					if (isAdd == 1) {
						if (conditionParamArr[i] == '0' || i == 0 || i != 12) {
							item = data;
						} else {
							var thisData = data.toString();
							var arr = conditionParamArr[i].split('_');
							if (thisData.length > 1) {
								for (var x = 0, lenx = arr.length; x < lenx; x++) {
									if (parseInt(parseInt(thisData) / 10) != arr[x]) {
										if (x == 0 || item.length <= 0) {
											item = item + arr[x];
										} else {
											item = item + '_' + arr[x];
										}
									}
								}
								item = item + '_' + thisData;
							} else {
								for (var x = 0, lenx = arr.length; x < lenx; x++) {
									// if (parseInt(parseInt(arr[x]) / 10) != thisData) {
									if (x == 0 || item.length <= 0) {
										item = item + arr[x];
									} else {
										item = item + '_' + arr[x];
									}
									// }
								}
								item = item + '_' + thisData;
							}
						}
					} else if (isAdd == 0) {
						if (i == 0) {
							var arr = [conditionParamArr[i]];
						} else {
							var arr = conditionParamArr[i].split('_');
						}
						if (arr.length <= 1) {
							item = '0';
						} else {
							for (var k = 0, lenn = arr.length; k < lenn; k++) {
								if (arr[k] != data) {
									if (item == '') {
										item = arr[k];
									} else {
										item = item + '_' + arr[k];
									}
								}
							}
						}
					} else if (isAdd == 3) {
						item = data;
					} else {
						item = '0';
					}
				} else {
					item = conditionParamArr[i];
				}
				if (item == '') {
					item = '0';
				}
				thisArr.push(item);
			}
			var param = '';
			for (var j = 0, leng = thisArr.length; j < leng; j++) {
				if (j == 0) {
					param = param + thisArr[j];
				} else {
					param = param + '-' + thisArr[j];
				}
			}
			url = postFixUrl + 'cars/' + param + '/';
			window.location.href = url;
		};
		//找车-条件按钮选车跳转url多选：暂时停止使用
		// this.HrefUrl = function(data, index, isAdd) { //配置条件url
		// 	url = '';
		// 	data = data ? data.toString() : '';
		// 	var thisArr = [];
		// 	for (var i = 0, len = conditionParamArr.length; i < len; i++) {
		// 		var item = '';
		// 		if (i == index) {
		// 			if (isAdd == 1) {
		// 				if (conditionParamArr[i] == '0' || i == 0) {
		// 					item = data;
		// 				} else {
		// 					var thisData = data.toString();
		// 					var arr = conditionParamArr[i].split('_');
		// 					if (thisData.length > 1) {
		// 						for (var x = 0, lenx = arr.length; x < lenx; x++) {
		// 							if (parseInt(parseInt(thisData) / 10) != arr[x]) {
		// 								if (x == 0 || item.length <= 0) {
		// 									item = item + arr[x];
		// 								} else {
		// 									item = item + '_' + arr[x];
		// 								}
		// 							}
		// 						}
		// 						item = item + '_' + thisData;
		// 					} else {
		// 						for (var x = 0, lenx = arr.length; x < lenx; x++) {
		// 							// if (parseInt(parseInt(arr[x]) / 10) != thisData) {
		// 							if (x == 0 || item.length <= 0) {
		// 								item = item + arr[x];
		// 							} else {
		// 								item = item + '_' + arr[x];
		// 							}
		// 							// }
		// 						}
		// 						item = item + '_' + thisData;
		// 					}
		// 				}
		// 			} else if (isAdd == 0) {
		// 				if (i == 0) {
		// 					var arr = [conditionParamArr[i]];
		// 				} else {
		// 					var arr = conditionParamArr[i].split('_');
		// 				}
		// 				if (arr.length <= 1) {
		// 					item = '0';
		// 				} else {
		// 					for (var k = 0, lenn = arr.length; k < lenn; k++) {
		// 						if (arr[k] != data) {
		// 							if (item == '') {
		// 								item = arr[k];
		// 							} else {
		// 								item = item + '_' + arr[k];
		// 							}
		// 						}
		// 					}
		// 				}
		// 			} else if (isAdd == 3) {
		// 				item = data;
		// 			} else {
		// 				item = '0';
		// 			}
		// 		} else {
		// 			item = conditionParamArr[i];
		// 		}
		// 		if (item == '') {
		// 			item = '0';
		// 		}
		// 		thisArr.push(item);
		// 	}
		// 	var param = '';
		// 	for (var j = 0, leng = thisArr.length; j < leng; j++) {
		// 		if (j == 0) {
		// 			param = param + thisArr[j];
		// 		} else {
		// 			param = param + '-' + thisArr[j];
		// 		}
		// 	}
		// 	url = postFixUrl + 'cars/' + param + '/';
		// 	window.location.href = url;
		// };
		// 找车-letter
		this.LetterSwitch = function(dom, isAllCase) {
			if (letterClick && dom) {
				var letter = dom.getAttribute('data-letter');
				if (CL != letter) OdCar.LoadBrand(isAllCase, letter);
				if (document.getElementById('condition-box').className == 'fixed') {
					var top = document.getElementById('brand-letter-' + letter).offsetTop - 120 - dom.offsetTop;;
				} else {
					var offset = document.cookie.indexOf('conditionFolder=1') < 0 ? 10 : 20;
					var top = document.getElementById('brand-letter-' + letter).offsetTop + document.getElementById('condition-box').offsetHeight + offset - 120 - dom.offsetTop;
				}
				if (document.querySelector('.letter-list.active')) {
					document.querySelector('.letter-list.active').className = 'letter-list';
				}
				dom.className = 'letter-list active';
				thisLetter = letter;
				window.scroll(0, top);
				letterClick = false;
			} else {
				var scrollTop;
				if (window.pageYOffset) {
					scrollTop = window.pageYOffset;
				} else {
					scrollTop = document.documentElement.scrollTop;
				}
				var letterTitleList = document.querySelectorAll('.brand-list-by-letter');
				for (var i = 0, len = letterTitleList.length; i < len; i++) {
					var letter = letterTitleList[i].getAttribute('data-letter');
					if (Od.Top(document.getElementById('letter-list-' + letter)) >= Od.Top(document.getElementById('brand-letter-' + letter)) - scrollTop - 3) {
						if (document.querySelector('.letter-list.active')) {
							document.querySelector('.letter-list.active').className = 'letter-list';
						}
						document.getElementById('letter-list-' + letter).className = 'letter-list active';
					}
				}

				var thisLetter = document.querySelector('.letter-list.active').getAttribute('data-letter');
				if (CL != thisLetter || CL == '') OdCar.LoadBrand(isAllCase, thisLetter);
			}
		};
		//找车-选项置顶
		this.ConditionDomFixed = function() {
			var scrollTop;
			var winHeight = window.innerHeight || document.documentElement.clientHeight;
			if (window.pageYOffset) {
				scrollTop = window.pageYOffset;
			} else {
				scrollTop = document.documentElement.scrollTop;
			}
			var condition = document.getElementById('condition-box'),
				h = (document.cookie.indexOf('conditionFolder=1') < 0) ? maxH : minH,
				line = document.querySelector('.condition-line'),
				conditionContainer = document.querySelector('.OdCarConditionContainer'),
				header = document.querySelector('.header'),
				brandListBox = document.querySelector('.brand-list-box'),
				letterNav = document.getElementById('letterListBox'),
				nav = document.querySelector('.nav'),
				isFolder;
			if (scrollTop > 0) {
				header.className = 'header fixed';
				if (scrollTop >= h - 50) {
					condition.className = 'fixed';
					line.className = 'condition-line fixed';
					brandListBox.style.paddingTop = h + 70 + 'px';
					isFolder = true;
					letterNav.className = 'letter-list-box fixed';
				} else {
					condition.className = '';
					line.className = 'condition-line';
					brandListBox.style.paddingTop = '';
					letterNav.className = 'letter-list-box';
				}
				nav.style.top = '61px';
			} else {
				header.className = 'header';
				condition.className = '';
				line.className = 'condition-line';
				brandListBox.style.paddingTop = '';
				letterNav.className = 'letter-list-box';
				(document.cookie.indexOf('conditionFolder=1') < 0) ? isFolder = false: isFolder = true;
				nav.style.top = '';
			}
			OdCar.Folder(document.getElementById('conditionFolderBtn'), false, isFolder);
		};
		//按字母异步加载车系
		this.LoadBrand = function(flag, letter) {
			var scrollTop;
			if (window.pageYOffset) {
				scrollTop = window.pageYOffset;
			} else {
				scrollTop = document.documentElement.scrollTop;
			}

			function brandList(letter, data) {
				var html = document.createElement('div');
				document.getElementById('brand-letter-' + letter).querySelector('.letter-title').style.display = 'block';
				document.getElementById('brand-letter-' + letter).className = 'brand-list-by-letter show';
				Od.Ajax({
					method: 'get', //方法
					url: '/htmldata/carsearch/' + letter + '.html', //接口地址
					asyc: false, //是否为异步
					success: function(data) {
						html.innerHTML = data;
					}
				});
				return html;
			}

			if (flag) { //如果全部条件则异步加载字母分类\
				if (letterClick) {
					if (document.getElementById('brand-letter-' + letter) && !document.getElementById('brand-letter-' + letter).querySelector('.brand-list-by-brand')) {
						var index = letterList.indexOf(letter);
						var nl = index + 1 >= letterList.length ? letterList[index] : letterList[index + 1];
						var pl = index - 1 >= 0 ? letterList[index - 1] : letterList[index];
						var la = [pl, letter, nl];
						var la1 = [];
						for (var i = 0, len = la.length; i < len; i++) {
							if (!document.getElementById('brand-letter-' + la[i]).querySelector('.brand-list-by-brand')) {
								la1.push(la[i]);
							}
						}
						CL = letter;
						if (la1.indexOf(pl) >= 0) document.getElementById('brand-letter-' + pl).appendChild(brandList(pl));
						if (la1.indexOf(letter) >= 0) document.getElementById('brand-letter-' + letter).appendChild(brandList(letter));
						if (la1.indexOf(nl) >= 0) document.getElementById('brand-letter-' + nl).appendChild(brandList(nl));
					}
				} else {
					var index = letterList.indexOf(letter);
					var nl = index + 1 >= letterList.length ? letterList[index] : letterList[index + 1];
					var pl = index - 1 >= 0 ? letterList[index - 1] : letterList[index];
					var la = [pl, nl];
					var la1 = [];
					for (var i = 0, len = la.length; i < len; i++) {
						if (!document.getElementById('brand-letter-' + la[i]).querySelector('.brand-list-by-brand')) {
							la1.push(la[i]);
						}
					}
					CL = letter;
					if (CL != letterList[letterList.indexOf(CL) + 1] || CL != letterList[letterList.indexOf(CL) - 1]) {
						CL = letter
					}
					if (document.getElementById('brand-letter-' + nl) && !document.getElementById('brand-letter-' + nl).querySelector('.brand-list-by-brand')) {
						document.getElementById('brand-letter-' + nl).appendChild(brandList(nl));
					}
					if (document.getElementById('brand-letter-' + pl) && !document.getElementById('brand-letter-' + pl).querySelector('.brand-list-by-brand')) {
						document.getElementById('brand-letter-' + pl).appendChild(brandList(pl));
					}
				}
				var showList = document.querySelectorAll('.brand-list-by-letter.show');
				if (showList[showList.length - 1].offsetHeight < winHeight) {
					var lastLetter = showList[showList.length - 1].getAttribute('data-letter');
					var index = letterList.indexOf(lastLetter) + 1;
					if (letterList[index] && document.getElementById('brand-letter-' + letterList[index]) && !document.getElementById('brand-letter-' + letterList[index]).querySelector('.brand-list-by-brand')) {
						CL = letter;
						document.getElementById('brand-letter-' + letterList[index]).appendChild(brandList(letterList[index]));
					}
				}
			}
		};
		//========================================================================================================//
		//车型相关页面fixed；
		this.DomFixed = function() {
			var scrollTop;
			if (window.pageYOffset) {
				scrollTop = window.pageYOffset;
			} else {
				scrollTop = document.documentElement.scrollTop;
			}
			if (scrollTop > 100) {
				document.querySelector('.header').className = 'header fixed';
				document.body.style.paddingTop = '100px';
				if (document.querySelector('.car-nav')) document.querySelector('.car-nav').className = "car-nav fixed";
				if (document.querySelector('.OdCar-cars-right')) {
					document.querySelector('.OdCar-cars-right').className = "OdCar-cars-right fixed";
					document.querySelector('.OdCar-cars-right').style.top = '112px';
				}
				if (document.querySelector('.nav')) document.querySelector('.nav').style.top = '112px';
				if (document.querySelector('.cars-by-factory')) {
					var configBox = document.querySelector('.cars-by-factory');
					var top = configBox.offsetTop;
					var h = configBox.offsetHeight;
					if (scrollTop + 102 >= top) {
						configBox.className = 'cars-by-factory fixed';
						document.querySelector('.car-nav').className = document.querySelector('.car-nav').className + ' gray';
						document.querySelector('.nav').style.top = '150px';
						document.querySelector('.OdCar-cars-right').style.top = '150px';
					}
					if (scrollTop + 102 < top || scrollTop + 102 > top + h) {
						configBox.className = 'cars-by-factory';
						document.querySelector('.car-nav').className = document.querySelector('.car-nav').className.replace('gray', '');
						document.querySelector('.nav').style.top = '112px';
						if (document.querySelector('.OdCar-cars-right')) document.querySelector('.OdCar-cars-right').style.top = '112px';
					}
				}
			} else {
				if (document.querySelector('.car-nav')) document.querySelector('.car-nav').className = "car-nav";
				if (document.querySelector('.nav')) document.querySelector('.nav').style.top = '61px';
				document.querySelector('.header').className = 'header';
				document.body.style.paddingTop = '0px';
				if (document.querySelector('.nav')) document.querySelector('.nav').style.top = '101px';
				if (document.querySelector('.OdCar-cars-right')) document.querySelector('.OdCar-cars-right').className = 'OdCar-cars-right';
			}
			// var configBox = document.querySelector('.cars-by-factory');
			// var top = configBox.offsetTop;
			// var h = configBox.offsetHeight;
			// if (scrollTop >= 152) {
			// 	document.querySelector('.car-nav').className = "car-nav fixed";
			// 	document.querySelector('.nav').style.top = '63px';
			// 	if (scrollTop >= top && scrollTop < h + top - 65) {
			// 		configBox.className = 'cars-by-factory fixed';
			// 		document.querySelector('.car-nav').className = document.querySelector('.car-nav').className + ' gray';
			// 		document.querySelector('.nav').style.top = '100px';
			// 	} else {
			// 		configBox.className = 'cars-by-factory';
			// 		document.querySelector('.car-nav').className = document.querySelector('.car-nav').className.replace('gray', '');
			// 		document.querySelector('.nav').style.top = '63px';
			// 	}
			// } else {
			// 	document.querySelector('.car-nav').className = "car-nav";
			// 	document.querySelector('.nav').style.top = '100px';
			// }
		};
		//参数配置
		this.Config = function(res, thisCarxId) {
			var that = this.Config;
			var configData = [];
			var allData = [];
			var emptyChecked = false;
			var sameChecked = false;
			var isHighLight = false;
			var brand = '';
			var carsName = '';
			var apiUrl;
			var apiData;
			if (res.type == 'pk') {
				apiUrl = '/api/car/carxpk';
				apiData = {
					'carxids': window.location.href.match(/(configpk\/)(.*)(\/)/g)[0].replace('configpk/', '').replace('/', '')
				}
			} else if (res.type == 'series') {
				apiUrl = '/api/car/carsconfig';
				apiData = {
					'carsid': window.location.href.match(/(config\/)(.*)([0-9]\/)/g)[0].replace('config/', '').replace('/', '')
				};
			} else {
				apiUrl = '/api/car/carxlistconfig';
				apiData = {
					'carxid': thisCarxId
				}
			}
			var pvareaId = thisCarxId;
			Od.Ajax({
				method: 'post', //方法
				url: apiUrl, //接口地址
				asyc: false, //是否为异步
				data: apiData,
				before: function() {},
				success: function(data) { //请求成功
					if (res.type == 'pk') {
						var tempData = data.body.configs.list;
						var idArr = (apiData.carxids).split(',');
						for (var z = 0, lenz = idArr.length; z < lenz; z++) {
							for (var y = 0, leny = tempData.length; y < leny; y++) {
								if (tempData[y].spec_id == idArr[z]) {
									configData.push(tempData[y]);
									allData.push(tempData[y]);
								}
							}
						}
					} else {
						document.getElementsByTagName('title')[0].innerText = data.body.configs.list[0].spec_name;
						if (pvareaId) {
							var pvarea;
							for (var i = 0, len = data.body.configs.list.length; i < len; i++) {
								if (data.body.configs.list[i].spec_id == pvareaId) {
									data.body.configs.list[i].current = true;
									pvarea = data.body.configs.list[i];

								} else {
									data.body.configs.list[i].current = false;
									configData.push(data.body.configs.list[i]);
									allData.push(data.body.configs.list[i]);
								}
							}
							configData.splice(0, 0, pvarea);
							allData.splice(0, 0, pvarea);
						} else {
							configData = data.body.configs.list;
							allData = data.body.configs.list;
						}

					}
					var emptyData = new Object;
					emptyData.spec_id = '';
					emptyData.spec_name = '';
					emptyData.brand_id = '';
					emptyData.brand_name = '请选择';
					emptyData.series_id = '';
					emptyData.series_name = '请选择';
					var item = [];
					emptyData.items = [];
					for (var i = 0, len = configData[0].items.length; i < len; i++) {
						var confs = [];
						for (var j = 0, lenn = configData[0].items[i].confs.length; j < lenn; j++) {
							confs.push({
								'item': configData[0].items[i].confs[j].item,
								'spec_id': '',
								'sub': configData[0].items[i].confs[j].sub,
								'value': ''
							});
						}
						emptyData.items.push({
							'name': configData[0].items[i].name,
							'confs': confs,
						})
					}
					if (res.type == 'pk' && configData.length < 4) {
						for (var x = 0, lenx = 4 - configData.length; x < lenx; x++) {
							configData.push(emptyData);
						}
					}
				}
			});
			var t = Od.Top(res.target);
			that.fixed = function(target) {
				var w = document.querySelector('.OdCarConfigTable').offsetWidth;
				var h = document.querySelector('.OdCarConfigTableHeader').offsetHeight;
				var l = Od.Left(document.querySelector('.OdCarConfigTable'));
				var tt = Od.Top(document.querySelectorAll('.itemsTitle')[0]) - 1;
				if (window.pageYOffset) {
					var scrollTop = window.pageYOffset;
				} else {
					var scrollTop = document.documentElement.scrollTop;
				}
				if (window.pageXOffset) {
					var scrollLeft = window.pageXOffset;
				} else {
					var scrollLeft = document.documentElement.scrollLeft;
				}
				if (scrollTop > 0) {
					document.querySelector('.header').style.top = -(scrollTop) + 'px';
				} else {
					document.querySelector('.header').style.top = '0px';
				}
				var scrollTopHeight = (res.type == 'pk') ? 100 : 322;
				if (scrollTop >= scrollTopHeight) {
					document.querySelector('.OdCarConfigNav').style.position = 'fixed';
					document.querySelector('.OdCarConfigNav').style.top = h - 10 + 'px';
					document.querySelector('.dummyHeader').style.display = 'block';
					document.querySelector('.OdCarConfigNav').style.left = -scrollLeft + l - 170 + 'px';
					document.querySelector('.carxNameConfig').className = 'carxNameConfig fixed';
					document.querySelector('.carxNameConfig').style.height = document.querySelector('.carxNameBox').offsetHeight + 'px';
					document.querySelector('.carxNameConfig').style.height = '58px';
					if (res.type == 'pk') {
						document.querySelector('.thInfoHeadDiv').className = 'thInfoHeadDiv fixed';
					}
					document.querySelector('.carxNameConfig').style.top = '0px';
					document.querySelector('.OdCarConfigTableHeader').className = 'OdCarConfigTableHeader fixed';
					document.querySelector('.OdCarConfigTableSide').style.top = tt - scrollTop + 'px';
					document.querySelector('.OdCarConfigTableHeader').style.left = l - scrollLeft + 'px';
					if (scrollLeft > l) {
						document.querySelector('.carxNameConfig').style.top = '0px';
						document.querySelector('.carxNameConfig').style.height = document.querySelector('.carxNameBox').offsetHeight + 'px';
						document.querySelector('.carxNameConfig').style.left = '0px';
						if (res.type == 'pk') {
							document.querySelector('.thInfoHeadDiv').style.top = document.querySelector('.carxNameBox').offsetHeight + 1 + 'px';
							document.querySelector('.thInfoHeadDiv').style.left = '0px';
						}
						document.querySelector('.OdCarConfigTableSide').style.display = 'table';
						if (document.querySelector('.car-nav') && document.querySelector('.config-filter')) {
							document.querySelector('.car-nav').style.marginLeft = scrollLeft - 180 + 'px';
							document.querySelector('.config-filter').style.marginLeft = scrollLeft - 180 + 'px';
						}
						document.querySelector('.header-container').style.transition = '0s linear';
						document.querySelector('.header-container').style.marginLeft = '0px';
					} else {
						if (document.querySelector('.car-nav') && document.querySelector('.config-filter')) {
							document.querySelector('.car-nav').style.marginLeft = '';
							document.querySelector('.config-filter').style.marginLeft = '';
						}
						document.querySelector('.header-container').style.transition = '0s linear';
						document.querySelector('.header-container').style.marginLeft = 180 - scrollLeft + 'px';;
						document.querySelector('.carxNameConfig').style.left = l - scrollLeft + 'px';
						// document.querySelector('.carxNameConfig').style.height = 'auto';
						document.querySelector('.carxNameConfig').style.height = document.querySelector('.carxNameBox').offsetHeight + 'px';
						if (res.type == 'pk') {
							document.querySelector('.thInfoHeadDiv').style.left = l - scrollLeft + 'px';
							document.querySelector('.thInfoHeadDiv').style.top = document.querySelector('.carxNameBox').offsetHeight + 1 + 'px';
						}
						document.querySelector('.OdCarConfigTableSide').style.display = 'none';
					}
				} else {
					document.querySelector('.OdCarConfigNav').style.position = 'absolute';
					document.querySelector('.OdCarConfigNav').style.top = document.querySelector('.OdCarConfigTableHeader').offsetHeight - 10 + 'px';
					document.querySelector('.OdCarConfigNav').style.left = '-170px';
					document.querySelector('.dummyHeader').style.display = 'none';
					document.querySelector('.OdCarConfigTableHeader').className = 'OdCarConfigTableHeader';
					if (scrollLeft > l) {
						document.querySelector('.carxNameConfig').className = 'carxNameConfig fixed';
						document.querySelector('.carxNameConfig').style.height = document.querySelector('.carxNameBox').offsetHeight + 'px';
						document.querySelector('.carxNameConfig').style.top = t - scrollTop + 'px';
						if (res.type == 'pk') {
							document.querySelector('.thInfoHeadDiv').className = 'thInfoHeadDiv fixed';
							document.querySelector('.thInfoHeadDiv').style.top = t + document.querySelector('.carxNameBox').offsetHeight + 1 - scrollTop + 'px';
							document.querySelector('.thInfoHeadDiv').style.left = '0px';
						}
						document.querySelector('.OdCarConfigTableSide').style.top = tt - scrollTop + 'px';
						document.querySelector('.carxNameConfig').style.left = '0px';
						document.querySelector('.OdCarConfigTableSide').style.display = 'table';
						if (document.querySelector('.car-nav') && document.querySelector('.config-filter')) {
							document.querySelector('.car-nav').style.marginLeft = scrollLeft - 180 + 'px';
							document.querySelector('.config-filter').style.marginLeft = scrollLeft - 180 + 'px';
						}
						document.querySelector('.header-container').style.transition = '0s linear';
						document.querySelector('.header-container').style.marginLeft = '0px';
					} else {
						if (document.querySelector('.car-nav') && document.querySelector('.config-filter')) {
							document.querySelector('.car-nav').style.marginLeft = '';
							document.querySelector('.config-filter').style.marginLeft = '';
						}
						document.querySelector('.header-container').style.transition = '0s linear';
						document.querySelector('.header-container').style.marginLeft = 180 - scrollLeft + 'px';
						document.querySelector('.carxNameConfig').style.height = 'auto';
						document.querySelector('.carxNameConfig').className = 'carxNameConfig';
						if (res.type == 'pk') {
							document.querySelector('.thInfoHeadDiv').className = 'thInfoHeadDiv';
						}
						document.querySelector('.OdCarConfigTableSide').style.display = 'none';
					}
				}
			};
			that.itemSwitch = function(target) {
				if (window.pageYOffset) {
					var scrollTop = window.pageYOffset;
				} else {
					var scrollTop = document.documentElement.scrollTop;
				}
				if (target == 'page') {
					for (var i = 0, len = document.querySelectorAll('.itemsTitle').length; i < len; i++) {
						if (Od.Top(document.querySelectorAll('.itemsTitle')[i]) - scrollTop <= Od.Top(document.querySelectorAll('.navLi')[i])) {
							for (var j = 0, lenn = document.querySelectorAll('.itemsTitle').length; j < lenn; j++) {
								document.querySelectorAll('.navLi')[j].className = 'navLi';
							}
							document.querySelectorAll('.navLi')[i].className = 'navLi active';
						}
					}
				} else {
					var scrollLeft;
					if (window.pageXOffset) {
						scrollLeft = window.pageXOffset;
					} else {
						scrollLeft = document.documentElement.scrollLeft;
					}
					document.querySelector('.navLi.active').className = 'navLi';
					target.className = 'navLi active';
					var top1 = Od.Top(document.getElementById('itemsTitle' + target.getAttribute('data-itemid')));
					var top2 = document.querySelector('.OdCarConfigTableHeader').offsetHeight;
					var top3 = parseInt(target.getAttribute('data-itemid')) * 28;
					window.scroll(scrollLeft, top1 - top2 - top3);
				}
			};
			that.html = function(data) {
				//配置导航
				var nav = document.createElement('ul');
				nav.className = 'OdCarConfigNav';
				//配置表
				var table = document.createElement('table');
				table.className = 'OdCarConfigTable';
				table.setAttribute('cellspacing', 1);
				table.style.width = (data.length + 1) * 200 + 'px';
				var tableBody = document.createElement('tbody'),
					headerTable = document.createElement('table'),
					leftTable = document.createElement('table'),
					trh = document.createElement('tr'),
					tdc = document.createElement('th'),
					highLight = document.createElement('div'),
					hideSame = document.createElement('div'),
					hideEmpty = document.createElement('div'),
					textHighlight = document.createElement('label'),
					textHideSame = document.createElement('label'),
					textHideEmpty = document.createElement('label'),
					inputHighlight = document.createElement('input'),
					inputHideSame = document.createElement('input'),
					inputHideEmpty = document.createElement('input');
				tdc.className = 'carxNameBox title';
				headerTable.appendChild(trh);
				headerTable.className = 'OdCarConfigTableHeader';
				headerTable.style.width = (data.length + 1) * 200 + 'px';
				leftTable.className = 'OdCarConfigTableSide';
				if (emptyChecked) {
					inputHideEmpty.checked = true;
				}
				inputHideEmpty.onchange = function() {
					if (this.checked) {
						emptyChecked = true;
					} else {
						emptyChecked = false;
					}
					that.filter(configData);
				};
				if (sameChecked) {
					inputHideSame.checked = true;
				}
				inputHideSame.onchange = function() {
					if (this.checked) {
						sameChecked = true;
					} else {
						sameChecked = false;
					}
					that.filter(configData);
				};
				if (isHighLight) {
					inputHighlight.checked = true;
				}
				inputHighlight.onchange = function() {
					if (this.checked) {
						isHighLight = true;
					} else {
						isHighLight = false;
					}
					that.filter(configData);
				};
				inputHighlight.id = 'showHighLight';
				inputHideSame.id = 'hideSame';
				inputHideEmpty.id = 'hideEmpty';
				textHighlight.setAttribute('for', 'showHighLight');
				textHideSame.setAttribute('for', 'hideSame');
				textHideEmpty.setAttribute('for', 'hideEmpty');
				textHighlight.innerText = '高亮显示差异参数';
				textHideSame.innerText = '隐藏相同参数';
				textHideEmpty.innerText = '隐藏暂无内容参数';
				inputHighlight.setAttribute('type', 'checkbox');
				inputHideSame.setAttribute('type', 'checkbox');
				inputHideEmpty.setAttribute('type', 'checkbox');
				highLight.appendChild(inputHighlight);
				highLight.appendChild(textHighlight);
				hideSame.appendChild(inputHideSame);
				hideSame.appendChild(textHideSame);
				hideEmpty.appendChild(inputHideEmpty);
				hideEmpty.appendChild(textHideEmpty);
				hideSame.className = 'hideSame';
				hideEmpty.className = 'hideEmpty';
				highLight.className = 'highLight';
				var filterBox = document.createElement('div');
				filterBox.className = 'carxNameConfig';
				filterBox.appendChild(highLight);
				filterBox.appendChild(hideSame);
				filterBox.appendChild(hideEmpty);
				tdc.appendChild(filterBox);
				trh.appendChild(tdc);
				//pk车型信息
				if (res.type == 'pk') {
					var trInfo = document.createElement('tr');
					// trInfo.style.lineHeight = '58px';
					var thInfoHead = document.createElement('th');
					thInfoHead.className = 'thInfoHead';
					thInfoHead.innerHTML = '<div class="thInfoHeadDiv">车型信息</div>';
					trInfo.appendChild(thInfoHead);
				}
				//品牌数据预先取得
				// var brandArr = [];
				// Od.Ajax({
				// 	method: 'post', //方法
				// 	url: '/api/car/brandlist', //接口地址
				// 	asyc: false, //是否为异步
				// 	before: function() {},
				// 	success: function(data) { //请求成功
				// 		var list = data.body.brand.list;
				// 		for (var i = 0, len = list.length; i < len; i++) {
				// 			brandArr.push({
				// 				'id': list[i].id,
				// 				'name': list[i].name,
				// 				'letter': list[i].abc
				// 			});
				// 		}
				// 	}
				// });
				for (var k = 0, leng = data.length; k < leng; k++) {
					var tdh = document.createElement('th');
					if (data[k].current) {
						tdh.style.backgroundColor = '#f9f9f9'
					}
					if (res.type == 'pk') {
						var tdhText = document.createElement('div');
						tdhText.className = 'carxNameDiv';
						var brandName = data[k].brand_name,
							carsName = data[k].series_name,
							brandId = data[k].brand_id,
							carsId = data[k].series_id;

						function addBrandInput(container) {
							var brandInput = new Od.CustomSelect({
								defaultValue: brandName,
								linkageName: 'input-brand' + k,
								height: 425,
								getData: function() {
									var arr = brandArr;
									return arr;
								},
								callBack: function(dom) {
									var container = dom.parentNode;
									var brandId = container.querySelector('.OdSelectContainer').getAttribute('data-id');
									var num = (container.querySelector('.OdSelectContainer').getAttribute('data-linkage')).replace(/[^0-9]/ig, "");
									container.removeChild(Od.Selector('data-linkage', 'input-cars' + num));
									container.removeChild(Od.Selector('data-linkage', 'input-carx' + num));
									var arr11 = [];
									Od.Ajax({
										method: 'post', //方法
										url: '/api/car/carslist', //接口地址
										asyc: false, //是否为异步
										data: {
											brandid: brandId
										},
										before: function() {},
										success: function(data) { //请求成功
											if (data.code == 1) {
												var list = data.body.cars.list;
												var list1 = data.body.cars.list1;
												// list = list.reverse();
												// list1 = list1.reverse();
												if (list && list.length > 0) {
													for (var i = 0, len = list.length; i < len; i++) {
														arr11.push({
															'id': list[i].id,
															'name': list[i].name,
															'factory': list[i].factory,
															'state': list[i].state
														});
													}
												}
												if (list1 && list1.length > 0) {
													for (var i = 0, len = list1.length; i < len; i++) {
														arr11.push({
															'id': list1[i].id,
															'name': list1[i].name,
															'factory': list1[i].factory,
															'state': list1[i].state
														});
													}
												}
											}
										}
									});
									if (arr11.length > 0) {
										addCarsInput(container, num, '请选择', arr11);
									} else {
										addCarsInput(container, num, '请选择', arr11, true);
									}
									addCarxInput(container, num, '请选择', '', true);
								}
							});
							container.appendChild(brandInput);
							container.setAttribute('brandid', brandId);
						};

						function addCarsInput(container, index, defaultValue, arr) {
							var carsInput = new Od.CustomSelect({
								defaultValue: defaultValue,
								height: 200,
								linkageName: 'input-cars' + index,
								getData: function() {
									if (arr.length <= 0) {
										Od.Ajax({
											method: 'post', //方法
											url: '/api/carspklist', //接口地址
											asyc: false, //是否为异步
											data: {
												brandid: container.getAttribute('brandid')
											},
											before: function() {},
											success: function(data) { //请求成功
												if (data.code == 1) {
													var list = data.body.cars.list;
													var list1 = data.body.cars.list1;
													// list = list.reverse();
													// list1 = list1.reverse();
													if (list && list.length > 0) {
														for (var i = 0, len = list.length; i < len; i++) {

															arr.push({
																'id': list[i].id,
																'name': list[i].name,
																'factory': list[i].factory,
																'state': list[i].state
															});

														}
													}
													if (list1 && list1.length > 0) {
														for (var i = 0, len = list1.length; i < len; i++) {

															arr.push({
																'id': list1[i].id,
																'name': list1[i].name,
																'factory': list1[i].factory,
																'state': list1[i].state
															});

														}
													}
												}

											}
										});
									}
									return arr;
								},
								callBack: function(dom) {
									var num = (container.querySelector('.OdSelectContainer').getAttribute('data-linkage')).replace(/[^0-9]/ig, "");
									var carsId = Od.Selector('data-linkage', 'input-cars' + num).getAttribute('data-id');
									container.removeChild(Od.Selector('data-linkage', 'input-carx' + num));
									var arr22 = [];
									Od.Ajax({
										method: 'post', //方法
										url: '/api/car/getpkallspec', //接口地址
										asyc: false, //是否为异步
										data: {
											carsid: carsId
										},
										before: function() {},
										success: function(data) { //请求成功
											var list = data.body.carx.list;
											for (var i = 0, len = list.length; i < len; i++) {
												if (list[i].isconfig == 1) {
													arr22.push({
														'id': list[i].id,
														'name': list[i].name
													});
												}
											}
										}
									});
									if (arr22.length > 0) {
										addCarxInput(container, num, '请选择', arr22);
									} else {
										addCarxInput(container, num, '请选择', arr22, true);
									}

								}
							});
							container.appendChild(carsInput);
							container.setAttribute('carsid', carsId);
						}

						function addCarxInput(container, index, defaultValue, arr, disabled) {
							var carxInput = new Od.CustomSelect({
								disabled: disabled,
								defaultValue: defaultValue,
								height: 200,
								linkageName: 'input-carx' + index,
								getData: function() {
									if (arr.length <= 0) {
										Od.Ajax({
											method: 'post', //方法
											url: '/api/car/carxlist', //接口地址
											asyc: false, //是否为异步
											data: {
												carsid: container.getAttribute('carsid')
											},
											before: function() {},
											success: function(data) { //请求成功
												if (data.code == 1) {
													var list = data.body.carx.list;
													for (var i = 0, len = list.length; i < len; i++) {
														if (list[i].isconfig == 1) {
															arr.push({
																'id': list[i].id,
																'name': list[i].name
															});
														}
													}
												}
											}
										});
									}
									return arr;
								},
								callBack: function() {
									var arr33 = '';
									for (var i = 0, len = data.length; i < len; i++) {
										if (i == index) {
											arr33 = arr33 + ',' + parseInt(carxInput.getAttribute('data-id'));
										} else {
											if (data[i].spec_id != '') {
												arr33 = arr33 + ',' + data[i].spec_id;
											}
										}
									}
									arr33 = arr33.replace(',', '');
									window.location.href = '/car/series/configpk/' + arr33 + '/';
								}
							});
							container.appendChild(carxInput);
						};
						//进入页面返回当前PK车型的品牌 / 车系 / 车型（ 需要提供品牌id和车系id）
						var arr1 = [];
						var arr2 = [];
						// Od.Ajax({
						// 	method: 'post', //方法
						// 	url: '/api/car/carslist', //接口地址
						// 	asyc: false, //是否为异步
						// 	data: {
						// 		brandid: brandId
						// 	},
						// 	before: function() {},
						// 	success: function(data) { //请求成功
						// 		if (data.code == 1) {
						// 			var list = data.body.cars.list;
						// 			if (list && list.length > 0) {
						// 				for (var i = 0, len = list.length; i < len; i++) {
						// 					arr1.push({
						// 						'id': list[i].id,
						// 						'name': list[i].name
						// 					});
						// 				}
						// 			}
						// 		}

						// 	}
						// });
						// Od.Ajax({
						// 	method: 'post', //方法
						// 	url: '/api/car/carxlist', //接口地址
						// 	asyc: false, //是否为异步
						// 	data: {
						// 		carsid: carsId
						// 	},
						// 	before: function() {},
						// 	success: function(data) { //请求成功
						// 		if (data.code == 1) {
						// 			var list = data.body.carx.list;
						// 			for (var i = 0, len = list.length; i < len; i++) {
						// 				arr2.push({
						// 					'id': list[i].id,
						// 					'name': list[i].name
						// 				});
						// 			}
						// 		}
						// 	}
						// });
						addBrandInput(tdhText);
						addCarsInput(tdhText, k, carsName, arr1);
						addCarxInput(tdhText, k, data[k].spec_name, arr2);
					} else {
						var tdhText = document.createElement('span');
						tdhText.className = 'carxNameText';
						tdhText.innerHTML = data[k].spec_name;
					}
					var tdhCloseBtn = document.createElement('a');
					tdhCloseBtn.setAttribute('href', 'javascript:void(0);');
					tdhCloseBtn.setAttribute('data-id', data[k].spec_id);
					tdhCloseBtn.innerHTML = '&times;';
					tdhCloseBtn.className = 'closeBtn';
					tdhCloseBtn.onclick = function() {
						that.removeCarX(this.getAttribute('data-id'));
					};
					if (k <= 0) {
						var moveLeftBtn = document.createElement('span');
						moveLeftBtn.className = 'OdCarConfigMoveLeft disabled';
					} else {
						var moveLeftBtn = document.createElement('a');
						moveLeftBtn.setAttribute('href', 'javascript:void(0);');
						moveLeftBtn.className = 'OdCarConfigMoveLeft';
						moveLeftBtn.setAttribute('data-index', k);
						moveLeftBtn.setAttribute('data-direct', 1);
						moveLeftBtn.setAttribute('data-id', data[k].spec_id);
						moveLeftBtn.onclick = function() {
							that.moveCarX(parseInt(this.getAttribute('data-index')), 0);
						}
					}
					moveLeftBtn.innerHTML = '<i></i>';
					if (k >= data.length - 1) {
						var moveRightBtn = document.createElement('span');
						moveRightBtn.className = 'OdCarConfigMoveRight disabled';
					} else {
						var moveRightBtn = document.createElement('a');
						moveRightBtn.setAttribute('href', 'javascript:void(0);');
						moveRightBtn.className = 'OdCarConfigMoveRight';
						moveRightBtn.setAttribute('data-index', k);
						moveRightBtn.setAttribute('data-direct', 1);
						moveRightBtn.setAttribute('data-id', data[k].spec_id);
						moveRightBtn.onclick = function() {
							that.moveCarX(parseInt(this.getAttribute('data-index')), 1);
						}
					}
					moveRightBtn.innerHTML = '<i></i>';
					// if(document.cookie){//加入对比从cookie里匹配是否已存在
					var addCompareBtn = document.createElement('a');
					addCompareBtn.setAttribute('href', 'javascript:void(0);');
					addCompareBtn.setAttribute('data-id', data[k].spec_id);
					if (res.type == 'pk') {
						addCompareBtn.innerHTML = '删除';
						if (data[k].spec_id) {
							addCompareBtn.className = 'OdCarConfigRemoveCompareBtn';
							addCompareBtn.onclick = function() {
								that.removeCarX(this.getAttribute('data-id'));
							};
						} else {
							addCompareBtn.className = 'OdCarConfigRemoveCompareBtnDisabled';
						}

					} else {
						addCompareBtn.className = 'OdCarConfigAddCompareBtn add-pk-btn';
						addCompareBtn.innerHTML = '加入对比';
					}

					// }
					var operateBox = document.createElement('div');
					if (res.type != 'pk') {
						operateBox.className = 'operateBox';
					} else {
						operateBox.className = 'operateBoxPk';
					}

					operateBox.appendChild(moveLeftBtn);
					operateBox.appendChild(addCompareBtn);
					operateBox.appendChild(moveRightBtn);
					tdh.className = 'carxNameBox';
					tdh.appendChild(tdhText);
					if (data.length > 1 && res.type != 'pk') {
						tdh.appendChild(tdhCloseBtn);
					}
					tdh.appendChild(operateBox);
					trh.appendChild(tdh);
					//pk车型信息
					if (res.type == 'pk') {
						var thInfo = document.createElement('th');
						thInfo.style.height = '58px';
						thInfo.innerHTML = '<span style="line-height:18px;display:block">' + data[k].spec_name + '</span>';
						trInfo.appendChild(thInfo);
					}
				}
				headerTable.appendChild(trh);
				if (res.type == 'pk') {
					headerTable.appendChild(trInfo);
				}
				for (var i = 0, len = data[0].items.length; i < len; i++) {
					//导航列表
					var navLi = document.createElement('li');
					navLi.setAttribute('data-itemid', i);
					navLi.className = 'navLi';
					if (i == 0) {
						navLi.className = 'navLi active';
					}
					var navA = document.createElement('a');
					var navArrow = document.createElement('em');
					navA.setAttribute('href', 'javascript:void(0);');
					navA.innerHTML = data[0].items[i].name;
					navLi.appendChild(navA);
					navLi.appendChild(navArrow);
					navLi.onclick = function() {
						that.itemSwitch(this);
					};
					nav.appendChild(navLi);
					// if (data[0].items[i].confs.length > 0) {//是否隐藏标题
					var tr1 = document.createElement('tr');
					var trL = document.createElement('tr');
					var th = document.createElement('th');
					var thL = document.createElement('th');
					th.setAttribute('data-itemid', i);
					th.id = 'itemsTitle' + i;
					th.setAttribute('colspan', data.length + 1);
					th.innerHTML = '&nbsp;&nbsp;&nbsp;&nbsp;' + data[0].items[i].name;
					thL.innerHTML = '&nbsp;&nbsp;&nbsp;&nbsp;' + data[0].items[i].name;
					th.className = 'itemsTitle';
					thL.className = 'itemsTitleL';
					tr1.appendChild(th);
					trL.appendChild(thL);
					table.appendChild(tr1);
					leftTable.appendChild(trL);
					for (var k = 0, leng = data[0].items[i].confs.length; k < leng; k++) {
						var tr2 = document.createElement('tr');
						var trL2 = document.createElement('tr');
						tr2.className = 'OdCarConfigTableBody';
						tr2.onclick = function() {
							this.className == 'OdCarConfigTableBody' ? this.className = 'OdCarConfigTableBody active' : this.className = 'OdCarConfigTableBody';
						}
						for (var j = 0, lenn = data.length; j < lenn; j++) {
							if (j == 0) {
								var th2 = document.createElement('th');
								var thL2 = document.createElement('th');
								th2.innerHTML = data[j].items[i].confs[k].sub + '&nbsp;&nbsp;';
								th2.className = 'confs confsTitle';
								thL2.innerHTML = data[j].items[i].confs[k].sub + '&nbsp;&nbsp;';
								thL2.className = 'confs confsTitle';
								tr2.appendChild(th2);
								trL2.appendChild(thL2);
							}
							if (data[j].items[i].confs[k].highlight && isHighLight) {
								tr2.style.color = '#f00';
							}
							var td = document.createElement('td');
							td.className = 'confs';
							if (data[j].current) {
								td.style.backgroundColor = '#f9f9f9'
							}
							if (data[j].items[i].confs[k].value.indexOf('●') >= 0) {
								data[j].items[i].confs[k].value = data[j].items[i].confs[k].value.replace(/●/g, '<i style="font-size:20px">●</i>');
							}
							if (data[j].items[i].confs[k].value.indexOf('○') >= 0) {
								data[j].items[i].confs[k].value = data[j].items[i].confs[k].value.replace(/○/g, '<i style="font-size:20px">○</i>');
							}
							td.innerHTML = data[j].items[i].confs[k].value;
							tr2.appendChild(td);
						}
						leftTable.appendChild(trL2);
						table.appendChild(tr2);
					}
					// }
				}
				res.target.innerHTML = '';
				var dummyHeader = document.createElement('div');
				dummyHeader.className = 'dummyHeader';
				dummyHeader.style.display = 'none';
				res.target.appendChild(dummyHeader);
				res.target.appendChild(headerTable);
				res.target.appendChild(table);
				res.target.appendChild(leftTable);
				dummyHeader.style.height = document.querySelector('.OdCarConfigTableHeader').offsetHeight + 'px';
				var top = Od.Top(document.querySelectorAll('.itemsTitle')[0]);
				nav.style.top = document.querySelector('.OdCarConfigTableHeader').offsetHeight + 5 + 'px';
				nav.style.left = '-130px';
				res.target.appendChild(nav);
				that.fixed();
			};
			that.html(configData);
			that.removeCarX = function(carxId) {
				var thisData = [];
				for (var i = 0, len = configData.length; i < len; i++) {
					if (configData[i].spec_id != carxId) {
						thisData.push(configData[i]);
					}
				}
				console.log(thisData)
				var emptyData = new Object;
				emptyData.spec_id = '';
				emptyData.spec_name = '';
				emptyData.brand_id = '';
				emptyData.brand_name = '请选择';
				emptyData.series_id = '';
				emptyData.series_name = '请选择';
				var item = [];
				emptyData.items = [];
				for (var i = 0, len = configData[0].items.length; i < len; i++) {
					var confs = [];
					for (var j = 0, lenn = configData[0].items[i].confs.length; j < lenn; j++) {
						confs.push({
							'item': configData[0].items[i].confs[j].item,
							'spec_id': '',
							'sub': configData[0].items[i].confs[j].sub,
							'value': ''
						});
					}
					emptyData.items.push({
						'name': configData[0].items[i].name,
						'confs': confs,

					})
				}
				if (res.type == 'pk' && thisData.length < 4) {
					thisData.push(emptyData);
				}
				res.target.innerHTML = '';
				that.html(thisData);
				configData = thisData;
				that.filter(configData);
			};
			that.moveCarX = function(index, direct) {
				var thisData = [];
				if (direct == 0) {
					configData.splice(index - 1, 0, configData[index]);
					configData.splice(index + 1, 1);
				} else if (direct == 1) {
					configData.splice(index + 2, 0, configData[index]);
					configData.splice(index, 1);
				}
				that.html(configData);
				that.filter(configData);
			};
			that.filterData = function() {
				var ndArr = {
						'list': [],
						'items': '',
						'confs': ''
					},
					jgArr = {
						'list': [],
						'items': '',
						'confs': ''
					},
					bsxArr = {
						'list': [],
						'items': '',
						'confs': ''
					},
					fdjArr = {
						'list': [],
						'items': '',
						'confs': ''
					},
					qdfsArr = {
						'list': [],
						'items': '',
						'confs': ''
					},
					zwsArr = {
						'list': [],
						'items': '',
						'confs': ''
					},
					nyArr = {
						'list': [],
						'items': '',
						'confs': ''
					};
				for (var i = 0, len = configData.length; i < len; i++) {
					// var thisNd = (configData[i].items[0].confs[3].value).substr(0, 4);
					var thisNd = configData[i].spec_name;
					var reg = /[0-9]{4}款/;
					thisNd = thisNd.match(reg)[0];
					thisNd = thisNd.substr(0, 4);
					if (ndArr.list.indexOf(thisNd) < 0 && thisNd != '-') {
						ndArr.items = 0;
						ndArr.confs = 3;
						ndArr.list.push(thisNd);
					}
					var thisJg = configData[i].items[1].confs[8].value;
					if (jgArr.list.indexOf(thisJg) < 0 && thisJg != '-') {
						jgArr.items = 1;
						jgArr.confs = 8;
						jgArr.list.push(thisJg);
					}
					if (configData[i].items[3].name == '电动机') {
						var prevBsx, thisBsx = configData[i].items[4].confs[0].value;
						if (bsxArr.list.indexOf(thisBsx) < 0 && thisBsx != '-') {
							bsxArr.items = 4;
							bsxArr.confs = 0;
							bsxArr.list.push(thisBsx);
						}
					} else {
						var prevBsx, thisBsx = configData[i].items[3].confs[0].value;
						if (bsxArr.list.indexOf(thisBsx) < 0 && thisBsx != '-') {
							bsxArr.items = 3;
							bsxArr.confs = 0;
							bsxArr.list.push(thisBsx);
						}
					}
					var thisFdj = (configData[i].items[0].confs[4].value);
					if (fdjArr.list.length <= 0) {
						fdjArr.items = 0;
						fdjArr.confs = 4;
						fdjArr.list.push(thisFdj);
					} else {
						var canPush = true;
						for (var j = 0, lenn = fdjArr.list.length; j < lenn; j++) {
							if (fdjArr.list[j].indexOf(thisFdj.split(/\s/)[0]) >= 0 || thisFdj == '-') {
								canPush = false
							}
						}
						if (canPush) {
							fdjArr.items = 0;
							fdjArr.confs = 4;
							fdjArr.list.push(thisFdj);
						}
					}
					if (configData[i].items[4].name == '变速箱') {
						var thisQdfs = configData[i].items[5].confs[0].value;
						if (qdfsArr.list.indexOf(thisQdfs) < 0 && thisQdfs != '-') {
							qdfsArr.items = 5;
							qdfsArr.confs = 0;
							qdfsArr.list.push(thisQdfs);
						}
					} else {
						var thisQdfs = configData[i].items[4].confs[0].value;
						if (qdfsArr.list.indexOf(thisQdfs) < 0 && thisQdfs != '-') {
							qdfsArr.items = 4;
							qdfsArr.confs = 0;
							qdfsArr.list.push(thisQdfs);
						}
					}

					var thisZws = configData[i].items[1].confs[10].value;
					if (zwsArr.list.indexOf(thisZws) < 0 && thisZws != '-') {
						zwsArr.items = 1;
						zwsArr.confs = 10;
						zwsArr.list.push(thisZws);
					}

					var thisRy = configData[i].items[2].confs[17].value;
					if (nyArr.list.indexOf(thisRy) < 0 && thisRy != '-') {
						nyArr.items = 2;
						nyArr.confs = 17;
						nyArr.list.push(thisRy);
					}

				}
				var filters = [{
					'name': 'filter-nd',
					'items': -1,
					'confs': -1,
					'value': ndArr.list.sort()
				}, {
					'name': 'filter-jg',
					'items': jgArr.items,
					'confs': jgArr.confs,
					'value': jgArr.list
				}, {
					'name': 'filter-bsx',
					'items': bsxArr.items,
					'confs': bsxArr.confs,
					'value': bsxArr.list.sort()
				}, {
					'name': 'filter-fdj',
					'items': fdjArr.items,
					'confs': fdjArr.confs,
					'value': fdjArr.list.sort()
				}, {
					'name': 'filter-qdfs',
					'items': qdfsArr.items,
					'confs': qdfsArr.confs,
					'value': qdfsArr.list.sort()
				}, {
					'name': 'filter-zws',
					'items': zwsArr.items,
					'confs': zwsArr.confs,
					'value': zwsArr.list.sort()
				}, {
					'name': 'filter-ny',
					'items': nyArr.items,
					'confs': nyArr.confs,
					'value': nyArr.list.sort()
				}];
				for (var i = 0, len = filters.length; i < len; i++) {
					var dom = document.getElementById(filters[i].name);
					for (var j = 0, lenn = filters[i].value.length; j < lenn; j++) {
						var label = document.createElement('label');
						var checkBox = document.createElement('input');
						var filterValue = filters[i].value[j];
						if (filters[i].items == 0 && filters[i].confs == 3) {
							filterValue = filterValue.substr(0, 4);
						}
						if (filters[i].items == 0 && filters[i].confs == 4) {
							filterValue = (filters[i].value[j]).split(/\s/);
							filterValue = filterValue[0];
						}
						checkBox.setAttribute('type', 'checkbox');
						checkBox.id = filters[i].name + j;
						checkBox.value = filterValue;
						dom.setAttribute('items', filters[i].items);
						dom.setAttribute('confs', filters[i].confs);
						checkBox.setAttribute('items', filters[i].items);
						checkBox.setAttribute('confs', filters[i].confs);
						if (filters[i].value.length <= 1) {
							checkBox.setAttribute('disabled', 'disabled');
							// checkBox.checked = true;
						}
						checkBox.className = 'filter-input';
						var em = document.createElement('em');
						em.innerHTML = filterValue;
						em.innerHTML = filterValue;
						if (filters[i].name == 'filter-nd') {
							em.innerHTML = filterValue + '款';
						}
						if (filters[i].name == 'filter-zws') {
							em.innerHTML = filterValue + '座';
						}
						if (filters[i].name == 'filter-jg' && filters[i].value[0].indexOf('厢车') > 0) {
							em.innerHTML = filterValue.replace('车', '');
						}
						label.appendChild(checkBox);
						label.appendChild(em);
						label.setAttribute('for', filters[i].name + j);
						dom.appendChild(label);
						checkBox.onchange = function() {
							var val = this.value;
							var tempData = [];
							var cellList = document.querySelectorAll('.cell-input');
							var selectFlag = false;
							for (var i = 0, len = allData.length; i < len; i++) {
								var filterArr = [];
								var flag = true;
								for (var j = 0, lenn = cellList.length; j < lenn; j++) {
									var items = cellList[j].getAttribute('items');
									var confs = cellList[j].getAttribute('confs');
									filterArr.push([]);
									var inputList = cellList[j].querySelectorAll('.filter-input');
									for (var k = 0, leng = inputList.length; k < leng; k++) {
										if (inputList[k].checked && !inputList[k].disabled) {
											filterArr[j].push(inputList[k].value);
										}
									}
									if (items == -1 && confs == -1) {
										v = allData[i].spec_name;
										var reg = /[0-9]{4}款/;
										v = v.match(reg)[0];
										v = v.substr(0, 4);
									} else if (items == 0 && confs == 4) {
										var v = allData[i].items[items].confs[confs].value;
										v = v.split(/\s/);
										v = v[0];
									} else {
										var v = allData[i].items[items].confs[confs].value;
									}
									if (filterArr[j].indexOf(v) < 0 && filterArr[j].length > 0) {
										flag = false;
										break;
									}
								}
								if (flag) {
									tempData.push(allData[i]);
								}

							}
							configData = tempData;
							selectFlag = false;
							for (var i = 0, len = document.querySelectorAll('.filter-input').length; i < len; i++) {
								if (document.querySelectorAll('.filter-input')[i].checked && !document.querySelectorAll('.filter-input')[i].disabled) {
									selectFlag = true;
									break;
								}
							}
							console.log(tempData)
							if (selectFlag == false) {
								that.html(configData);
							}
							if (tempData.length <= 0) {
								document.getElementById('config').innerHTML = '';
							} else {
								that.html(tempData);
							}

						};
					}
				}
			};
			if (res.type != 'pk') {
				that.filterData();
			}
			that.filter = function(configData) {
				var thisData = [];
				for (var x = 0, lenx = configData.length; x < lenx; x++) {
					var thisItems = [];
					for (var y = 0, leny = configData[x].items.length; y < leny; y++) {
						var thisConfs = [];
						thisItems.push({
							'name': configData[x].items[y].name,
							'confs': thisConfs
						})
					}
					var thisDataObj = {
						'brand_id': configData[x].brand_id,
						'brand_name': configData[x].brand_name,
						'series_id': configData[x].series_id,
						'series_name': configData[x].series_name,
						'current': configData[x].current,
						'spec_name': configData[x].spec_name,
						'spec_id': configData[x].spec_id,
						'items': thisItems
					};
					thisData.push(thisDataObj);
				}
				for (var i = 0, len = configData[0].items.length; i < len; i++) {
					for (var j = 0, lenn = configData[0].items[i].confs.length; j < lenn; j++) {
						var thisVal;
						for (var k = 0, leng = configData.length; k < leng; k++) {
							var flag = false;
							if (k == 0) {
								thisVal = configData[k].items[i].confs[j].value;
							}
							if (emptyChecked || sameChecked) {
								if (sameChecked) {
									if (configData[k].items[i].confs[j].value != thisVal && configData[k].items[i].confs[j].value != '') {
										configData[k].items[i].confs[j].highlight = isHighLight;
										flag = true;
										break;
									} else {
										configData[k].items[i].confs[j].highlight = false;
									}
								} else {
									if (configData[k].items[i].confs[j].value != '-' && configData[k].items[i].confs[j].value != '') {
										flag = true;
										break;
									}
								}
							} else {
								if (configData[k].items[i].confs[j].value != thisVal && configData[k].items[i].confs[j].value != '') {
									configData[k].items[i].confs[j].highlight = isHighLight;
								}
								flag = true;
							}
						}
						if (flag) {
							for (var m = 0, lenm = configData.length; m < lenm; m++) {
								thisData[m].items[i].confs.push(configData[m].items[i].confs[j]);
							}

						}
					}
				}
				that.html(thisData);
			};
			window.onscroll = function() {
				that.itemSwitch('page');
				that.fixed();
			};
		};
		//PK品牌列表
		this.BrandDom = function() {
			var selectContainer = document.createElement('div');
			selectContainer.className = 'select-container';
			var brandList = document.createElement('ul');
			brandList.className = 'pkBrandList';
			var letterList = document.createElement('div');
			letterList.className = 'pkLetterList';
			for (var i = 0, len = OdBrandDataList.length; i < len; i++) {
				var dataItem = OdBrandDataList[i];
				if (i == 0 || dataItem.abc != OdBrandDataList[i - 1].abc) {
					var letterBtn = document.createElement('a');
					letterBtn.setAttribute('href', 'javascript:;');
					letterBtn.innerText = dataItem.abc;

					letterBtn.onclick = function() {
						var thisLetter = this.innerText;
						var thisMenu = this.parentNode.parentNode;
						var top = document.getElementById('pkMenuLetterTitle-' + thisLetter).offsetTop;
						// if (top > thisMenu.querySelector('.pk-select').offsetHeight - menuHeight) {
						// 	top = thisMenu.querySelector('.pk-select').offsetHeight - menuHeight;
						// }
						thisMenu.querySelector('.pkBrandList').style.top = -top + 'px';
						thisMenu.querySelector('.handle').style.top = top * 425 / thisMenu.querySelector('.pkBrandList').offsetHeight + 'px';
					};
					letterList.appendChild(letterBtn);
					var letterTitle = document.createElement('h5');
					letterTitle.className = 'pk-letter-title';
					letterTitle.id = 'pkMenuLetterTitle-' + dataItem.abc;
					letterTitle.innerHTML = dataItem.abc;
					brandList.appendChild(letterTitle);
				}
				var brandItem = document.createElement('li');
				brandItem.className = 'brand-item';
				brandItem.setAttribute('brandid', dataItem.id);
				brandItem.setAttribute('brandname', dataItem.name);
				brandItem.onclick = function() {
					document.getElementById('pkContainer').setAttribute('brandid', this.getAttribute('brandid'));
					document.getElementById('pkContainer').setAttribute('brandname', this.getAttribute('brandname'));
					OdCar.CarsDom(this.getAttribute('brandid'), this.getAttribute('brandname'));
				};
				brandItem.innerHTML = '<a href="javascript:;">' + dataItem.name + '</a>';
				brandList.appendChild(brandItem);
			}
			selectContainer.appendChild(brandList);

			var pkSelectColum = document.createElement('h4');
			pkSelectColum.className = 'pk-select-colum';
			pkSelectColum.innerHTML = '<a href="javascript:;" class="pk-select-colum-brand" onclick="OdCar.BrandDom()">品牌</a>';
			document.querySelector('.pk-select-list-box').innerHTML = '';
			document.querySelector('.pk-select-list-box').appendChild(pkSelectColum);
			document.querySelector('.pk-select-list-box').appendChild(pkSelectColum);
			document.querySelector('.pk-select-list-box').appendChild(selectContainer);
			document.querySelector('.pk-select-list-box').style.height = '';
			Od.CustomScroll({
				target: 'select-container',
				height: 425,
				width: 238,
				barWidth: 3
			});
			selectContainer.appendChild(letterList);
		};
		//PK车系列表
		this.CarsDom = function(brandId) {
			var selectContainer = document.createElement('div');
			selectContainer.className = 'select-container';
			var ul = document.createElement('ul');
			ul.className = 'pkCarsList';
			Od.Ajax({
				method: 'post', //方法
				url: '/api/carspklist', //接口地址
				asyc: true, //是否为异步
				data: {
					brandid: brandId
				},
				success: function(data) { //请求成功
					var list = [];
					if (data.body.cars.list) {
						for (var i = 0, len = data.body.cars.list.length; i < len; i++) {
							list.push(data.body.cars.list[i]);
						}
					}
					if (data.body.cars.list1) {
						for (var i = 0, len = data.body.cars.list1.length; i < len; i++) {
							list.push(data.body.cars.list1[i]);
						}
					}
					for (var i = 0, len = list.length; i < len; i++) {
						var saleTitle = document.createElement('h5');
						saleTitle.className = 'saleTitle';
						if (i == 0) {
							var factoryTitle = document.createElement('h5');
							factoryTitle.className = 'factoryTitle';
							if (list[i].state == 20) {
								saleTitle.innerHTML = '在售';
							} else {
								saleTitle.innerHTML = '停售';
							}
							if (list[i].factory.name) {
								factoryTitle.innerHTML = list[i].factory.name;
							}
							ul.appendChild(saleTitle);
							ul.appendChild(factoryTitle);
						}
						if (i > 0) {
							var factoryTitle = document.createElement('h5');
							if (list[i].state != list[i - 1].state) {
								if (list[i].state == 20) {
									saleTitle.innerHTML = '在售';
								} else {
									saleTitle.innerHTML = '停售';
								}
								ul.appendChild(saleTitle);
							}
							if (list[i].factory.name != list[i - 1].factory.name || list[i].state != list[i - 1].state) {
								factoryTitle.innerHTML = list[i].factory.name;
								factoryTitle.className = 'factoryTitle';
								ul.appendChild(factoryTitle);
							}

						}
						var li = document.createElement('li');
						li.innerHTML = '<a href="javascript:;">' + list[i].name + '</a>';
						li.setAttribute('carsid', list[i].id);
						li.setAttribute('carsname', list[i].name);
						li.onclick = function() {
							document.getElementById('pkContainer').setAttribute('carsid', this.getAttribute('carsid'));
							document.getElementById('pkContainer').setAttribute('carsname', this.getAttribute('carsname'));
							OdCar.CarxDom(this.getAttribute('carsid'));
						};
						ul.appendChild(li);
					}
					selectContainer.appendChild(ul);
					var pkSelectColum = document.createElement('h4');
					pkSelectColum.className = 'pk-select-colum';
					pkSelectColum.innerHTML = '<a href="javascript:;" class="pk-select-colum-brand" onclick="OdCar.BrandDom()">品牌</a> > <a href="javascript:;" class="pk-select-colum-cars" onclick="OdCar.CarsDom(' + brandId + ');">' + document.getElementById('pkContainer').getAttribute('brandname') + '</a>';
					document.querySelector('.pk-select-list-box').innerHTML = '';
					document.querySelector('.pk-select-list-box').appendChild(pkSelectColum);
					document.querySelector('.pk-select-list-box').appendChild(pkSelectColum);
					document.querySelector('.pk-select-list-box').appendChild(selectContainer);
					var ulHeight = document.querySelector('.pkCarsList').offsetHeight;
					if (ulHeight < 425) {
						var h = ulHeight;
						document.querySelector('.pk-select-list-box').style.height = h + 26 + 'px';
					} else {
						var h = 425;
						document.querySelector('.pk-select-list-box').style.height = '';
					}
					Od.CustomScroll({
						target: 'select-container',
						height: h,
						width: 238,
						barWidth: 3
					});
				}
			});
		};
		//PK车型列表
		this.CarxDom = function(carsId) {
			var selectContainer = document.createElement('div');
			selectContainer.className = 'select-container';
			var ul = document.createElement('ul');
			ul.className = 'pkCarxList';
			Od.Ajax({
				method: 'post', //方法
				url: '/api/car/getpkallspec', //接口地址
				asyc: true, //是否为异步
				data: {
					carsid: carsId
				},
				success: function(data) { //请求成功
					var list = data.body.carx.list;
					for (var i = 0, len = list.length; i < len; i++) {
						if (list[i].isconfig == 1) {
							var li = document.createElement('li');
							li.setAttribute('data-id', list[i].id);
							li.innerHTML = '<a href="javascript:;">' + list[i].name + '</a>';
							li.onclick = function(e) {
								e = e || event || window.event;
								e.stopPropagation();
								document.querySelector('.pk-select-text').innerHTML = this.innerText;
								document.querySelector('.pk-select-list-box').style.display = 'none';
								OdCar.AddPk(this.getAttribute('data-id'));
							};
							ul.appendChild(li);
						}
					}
					if (ul.innerHTML == '') {
						ul.innerHTML = '<span style="display:block;margin-bottom:15px;margin-top:5px;text-align:center;font-size:14px;color:#ccc">暂无可查询车型</span>';
					}
					selectContainer.appendChild(ul);
					var pkSelectColum = document.createElement('h4');
					pkSelectColum.className = 'pk-select-colum';
					pkSelectColum.innerHTML = '<a href="javascript:;" class="pk-select-colum-brand" onclick="OdCar.BrandDom()">品牌</a> > <a href="javascript:;" class="pk-select-colum-cars" onclick="OdCar.CarsDom(' + document.getElementById('pkContainer').getAttribute('brandid') + ');">' + document.getElementById('pkContainer').getAttribute('brandname') + '</a> > <span>' + document.getElementById('pkContainer').getAttribute('carsname') + '</span>';
					document.querySelector('.pk-select-list-box').innerHTML = '';
					document.querySelector('.pk-select-list-box').appendChild(pkSelectColum);
					document.querySelector('.pk-select-list-box').appendChild(pkSelectColum);
					document.querySelector('.pk-select-list-box').appendChild(selectContainer);
					var ulHeight = document.querySelector('.pkCarxList').offsetHeight;
					if (ulHeight < 425) {
						var h = ulHeight;
						document.querySelector('.pk-select-list-box').style.height = h + 26 + 'px';
					} else {
						var h = 425;
						document.querySelector('.pk-select-list-box').style.height = '';
					}
					Od.CustomScroll({
						target: 'select-container',
						height: h,
						width: 238,
						barWidth: 3
					});
				}
			});
		};
		//车型PK入口
		this.PkBuild = function(container, h) {
			for (var i = 0, len = document.querySelectorAll('.add-pk-btn').length; i < len; i++) {
				var thisBtn = document.querySelectorAll('.add-pk-btn')[i];
				thisBtn.onclick = function() {
					if (document.getElementById('OdCar-aside')) document.getElementById('OdCar-aside').className = 'OdCar-aside active';
					if (document.getElementById('OdCar-pk-btn-aside')) document.getElementById('OdCar-pk-btn-aside').className = 'OdCar-pk-btn-aside';
					OdCar.AddPk(this.getAttribute('data-id'));

				};
			}
			if (!document.getElementById('pkContainer')) {
				var pkContainer = document.createElement('div');
				pkContainer.id = 'pkContainer';
				var pkTitle = document.createElement('h3');
				pkTitle.innerHTML = '车型对比';
				var pkCarxListBox = document.createElement('div');
				pkCarxListBox.className = 'pk-carx-list-box';
				var pkCarxList = document.createElement('ul');
				pkCarxList.className = 'pk-carx-list';
				pkCarxListBox.appendChild(pkCarxList);
				var pkSelect = document.createElement('div');
				pkSelect.className = 'pk-select';
				var pkSelectText = document.createElement('span');
				pkSelectText.className = 'pk-select-text';
				pkSelectText.innerText = '选择品牌';
				var pkSelectArrow = document.createElement('em');
				pkSelectArrow.className = 'pk-select-arrow';
				var pkSelectUlBox = document.createElement('div');
				pkSelectUlBox.className = 'pk-select-list-box';
				pkSelect.appendChild(pkSelectText);
				pkSelect.appendChild(pkSelectArrow);
				pkContainer.appendChild(pkTitle)
				pkContainer.appendChild(pkCarxListBox);
				pkContainer.appendChild(pkSelect);
				pkContainer.appendChild(pkSelectUlBox);
				var pkBtn = document.createElement('a');
				pkBtn.innerHTML = '开始对比';
				pkBtn.className = 'pkBtn';
				pkBtn.setAttribute('href', 'javascript:;');
				pkContainer.appendChild(pkBtn);
				container.appendChild(pkContainer);
			} else {
				var pkContainer = document.getElementById('pkContainer');
				var pkSelectColum = document.querySelector('.pk-select-colum');
			}
			OdCar.PkQuery(h);
			document.body.onclick = function(e) {
				Od.Bubble(Od.Target(e), ['pk-select', 'pk-select-list-box', 'pk-select-colum-brand'], function() {
					document.querySelector('.pk-select-list-box').style.display = 'block';
					if (document.querySelector('.pk-select-list-box').innerHTML == '') {
						OdCar.BrandDom();
					}
				}, function() {
					if (document.querySelector('.pk-select-list-box')) document.querySelector('.pk-select-list-box').style.display = 'none';
				});
			};
		};
		// 车型PK查询(返回加入PK的车型dom)
		this.PkQuery = function(h) {
			var cookie = document.cookie;
			var pkList = [];
			var addPkBtnList = document.querySelectorAll('.add-pk-btn');
			if (cookie.match(/(pklist\=\[)(.*?)(\])/g)) {
				pkList = cookie.match(/(pklist\=\[)(.*?)(\])/g)[0];
				pkList = pkList.replace('pklist=[', '').replace(']', '');
				var tempPkList = pkList.split(',');
				if (pkList != '') {
					for (var i = 0, len = addPkBtnList.length; i < len; i++) {
						if (tempPkList.indexOf(addPkBtnList[i].getAttribute('data-id')) >= 0) {
							addPkBtnList[i].innerText = '已对比';
							if (addPkBtnList[i].className.indexOf('pkdisabled') < 0) {
								addPkBtnList[i].className = addPkBtnList[i].className + ' pkdisabled';
							}
							addPkBtnList[i].onclick = function() {
								return false;
							}
						} else {
							if (window.location.href.indexOf('/spec/config/') >= 0 || window.location.href.indexOf('/series/config/') >= 0) {
								addPkBtnList[i].innerText = '加入对比';
							} else {
								addPkBtnList[i].innerText = '对比';
							}
							addPkBtnList[i].className = addPkBtnList[i].className.replace(' pkdisabled', '');
							addPkBtnList[i].onclick = function() {
								OdCar.AddPk(this.getAttribute('data-id'));
							}
						}
					}
					Od.Ajax({
						method: 'post', //方法
						url: '/api/car/carxpk', //接口地址
						asyc: false, //是否为异步
						data: {
							'carxids': pkList
						},
						before: function() {},
						success: function(data) {
							if (data.code == 1) {
								var list = data.body.configs.list;
								document.querySelector('.pk-carx-list').innerHTML = '';
								for (var i = 0, len = list.length; i < len; i++) {
									var li = document.createElement('li');
									li.innerHTML = '<span>' + list[i].spec_name + '</span>';
									var remove = document.createElement('a');
									remove.setAttribute('href', 'javascript:;');
									remove.setAttribute('data-id', list[i].spec_id);
									remove.innerHTML = '×';
									remove.className = 'remove';
									remove.onclick = function() {
										OdCar.RemovePk(this.getAttribute('data-id'));
									};
									li.appendChild(remove);
									document.querySelector('.pk-carx-list').appendChild(li);
								}
							}
							document.querySelector('.pkBtn').setAttribute('href', '/car/series/configpk/' + pkList + '/');
							document.querySelector('.pkBtn').setAttribute('target', '_blank');
						}
					});
				} else {
					for (var i = 0, len = addPkBtnList.length; i < len; i++) {
						if (window.location.href.indexOf('/spec/config/') >= 0 || window.location.href.indexOf('/series/config/') >= 0) {
							addPkBtnList[i].innerText = '加入对比';
						} else {
							addPkBtnList[i].innerText = '对比';
						}
						addPkBtnList[i].className = addPkBtnList[i].className.replace(' pkdisabled', '');
						addPkBtnList[i].onclick = function() {
							OdCar.AddPk(this.getAttribute('data-id'));
						}
					}
					document.querySelector('.pk-carx-list').innerHTML = '';
					document.querySelector('.pkBtn').setAttribute('href', 'javascript:;');
					document.querySelector('.pkBtn').setAttribute('target', '_self');
				}
			} else {
				for (var i = 0, len = addPkBtnList.length; i < len; i++) {
					if (window.location.href.indexOf('/spec/config/') >= 0 || window.location.href.indexOf('/series/config/') >= 0) {
						addPkBtnList[i].innerText = '加入对比';
					} else {
						addPkBtnList[i].innerText = '对比';
					}
					addPkBtnList[i].onclick = function() {
						OdCar.AddPk(this.getAttribute('data-id'));
					}
				}
			}
			if (winHeight - 575 < document.querySelector('.pk-carx-list').offsetHeight) {
				Od.CustomScroll({
					target: 'pk-carx-list-box',
					height: winHeight - 575,
					width: 255,
					barWidth: 3
				});
			} else {
				var thisDom = document.querySelector('.pk-carx-list-box');
				thisDom.style = '';
				if (thisDom.querySelector('.scrollBar')) thisDom.removeChild(thisDom.querySelector('.scrollBar'))
				thisDom.children[0].style = '';
			}
		};
		//加入PK
		this.AddPk = function(specId) {
			var addPkExpdate = new Date(); //初始化时间
			addPkExpdate.setTime(addPkExpdate.getTime() + 1000 * 60 * 60 * 24 * 182); //一年有效
			var cookie = document.cookie;
			if (cookie.match(/(pklist\=\[)(.*?)(\])/g)) {
				var pkList = cookie.match(/(pklist\=\[)(.*?)(\])/g)[0];
				pkList = pkList.replace('pklist=[', '').replace(']', '');
				var pkArr = pkList.split(',');
				if (pkArr.indexOf(specId) < 0) {
					if (pkList == '') {
						pkList = pkList + specId;
					} else {
						pkList = pkList + ',' + specId;
					}

				} else {
					Od.Alert({
						html: '已经添加此车型。', //弹出框html
					});
				}
			} else {
				pkList = specId;
			}
			document.cookie = 'pklist=[' + pkList + '];expires=' + addPkExpdate.toGMTString() + ';path=/';
			OdCar.PkQuery();
		};
		//删除PK
		this.RemovePk = function(specId) {
			var removePkExpdate = new Date(); //初始化时间
			removePkExpdate.setTime(removePkExpdate.getTime() + 1000 * 60 * 60 * 24 * 182); //一年有效	
			var cookie = document.cookie;
			var pkList = cookie.match(/(pklist\=\[)(.*?)(\])/g)[0];
			pkList = pkList.replace('pklist=[', '').replace(']', '');
			var pkArr = pkList.split(',');
			for (var i = 0, len = pkArr.length; i < len; i++) {
				if (pkArr[i] == specId) {
					pkArr.splice(i, 1);
					break;
				}
			}
			pkList = '';
			for (var i = 0, len = pkArr.length; i < len; i++) {
				if (i == 0) {
					pkList = pkList + pkArr[i];
				} else {
					pkList = pkList + ',' + pkArr[i];
				}
			}
			document.cookie = 'pklist=[' + pkList + '];expires=' + removePkExpdate.toGMTString() + ';path=/';
			OdCar.PkQuery();
		};
		//车系首页
		this.CarsHomePage = function(res) {
			// 车型切换==================
			function hideList() {
				for (var i = 0, len = document.querySelectorAll('.carx-list-box').length; i < len; i++) {
					document.querySelectorAll('.carx-list-box')[i].style.display = 'none';
				}
			}
			if (document.querySelector('.comming-btn')) {
				document.querySelector('.comming-btn').onclick = function() {
					this.className = 'comming-btn active';
					if (document.querySelector('.year-btn')) {
						document.querySelector('.year-btn').className = 'year-btn';
						document.querySelector('.year-val').innerText = '按年代';
					}
					if (document.querySelector('.being-btn')) document.querySelector('.being-btn').className = 'being-btn'
					hideList();
					document.getElementById('by-comming-sale').style.display = 'block';
				}
			}
			if (document.querySelector('.being-btn')) {
				document.querySelector('.being-btn').onclick = function() {
					this.className = 'being-btn active';
					if (document.querySelector('.year-btn')) {
						document.querySelector('.year-btn').className = 'year-btn';
						document.querySelector('.year-val').innerText = '按年代';
					}
					if (document.querySelector('.comming-btn')) document.querySelector('.comming-btn').className = 'comming-btn';
					hideList();
					document.getElementById('by-being-sale').style.display = 'block';
				}
			}
		};
		this.CarsHomePageCarxTurnByYear = function(dom) {
			var yearBtn = document.querySelector('.year-btn');
			var thisYear = dom.getAttribute('data-year');
			yearBtn.className = 'year-btn active';
			document.querySelector('.year-val').innerText = dom.innerText;
			if (document.querySelector('.being-btn')) document.querySelector('.being-btn').className = 'being-btn';
			if (document.querySelector('.comming-btn')) document.querySelector('.comming-btn').className = 'comming-btn';
			for (var i = 0, len = document.querySelectorAll('.carx-list-box').length; i < len; i++) {
				document.querySelectorAll('.carx-list-box')[i].style.display = 'none';
			}
			document.getElementById('by-year-' + thisYear).style.display = 'block';
		};
		//话题切换
		this.OpinionSlide = function(res) {
			var flag = true;
			var ul = document.getElementById('opinion-list');
			var slideWrapper = document.querySelector('.OdCar-cars-opinion');
			var liList = ul.getElementsByTagName('li');
			var i = 0;
			var handleRight = slideWrapper.querySelector('.arrow-next');
			var handleLeft = slideWrapper.querySelector('.arrow-prev');
			var canClick = true;

			function a() {
				if (flag == true) {
					ul.style.left = -590 * i + 'px';
					i++;
					b();
				}
			};
			var timer;

			function b() {
				if (i > liList.length - 1) {
					timer = setTimeout(function() {
						i = 0;
						ul.style.transition = 'left 0s ease-out';
						a();
					}, 5500);

				} else {
					timer = setTimeout(function() {
						ul.style.transition = 'left 0.5s ease-out';
						a();
					}, 5500);
				}
			};
			if (flag == true) {
				a();
			}
			slideWrapper.onmouseenter = function() {
				flag = false;
				clearTimeout(timer);
			};
			slideWrapper.onmouseleave = function() {
				flag = true;
				b();
			};
			handleRight.onclick = function() {
				if (this.className.indexOf('disabled') < 0) {
					flag = false;
					clearTimeout(timer);
					if (canClick) {
						canClick = false;
						i = i + 1;
						if (i > liList.length) {
							ul.style.transition = 'left 0s ease-out';
							ul.style.left = '0px';
							setTimeout(function() {
								ul.style.transition = 'left 0.5s ease-out';
								ul.style.left = -590 + 'px';
								i = 2;
							}, 30);
						} else {
							ul.style.left = -590 * (i - 1) + 'px';
						}
						setTimeout(function() {
							canClick = true;
						}, 500);
					}
				}

			};
			handleLeft.onclick = function() {
				if (this.className.indexOf('disabled') < 0) {
					flag = false;
					clearTimeout(timer);
					if (canClick) {
						canClick = false;
						i = i - 1;
						if (i < 1) {
							ul.style.transition = 'left 0s ease-out';
							ul.style.left = -590 * (liList.length - 1) + 'px';
							setTimeout(function() {
								ul.style.transition = 'left 0.5s ease-out';
								ul.style.left = -590 * (liList.length - 2) + 'px';
								i = liList.length - 1;
							}, 20);

						} else {
							ul.style.left = -590 * (i - 1) + 'px';
						}
						setTimeout(function() {
							canClick = true;
						}, 500);
					}
				}
			}
		};
		//图片页
		this.CarsPicture = function(res) {
			if (document.querySelector('.car-pic-index-carx-list') && document.querySelector('.carx-folder-btn')) {
				if (document.cookie.indexOf('picPageCarxFolder=1') >= 0) {
					document.querySelector('.car-pic-index-carx-list').className = 'car-pic-index-carx-list fold';
					document.querySelector('.carx-folder-btn').innerText = '展开';
				} else {
					document.querySelector('.car-pic-index-carx-list').className = 'car-pic-index-carx-list';
					document.querySelector('.carx-folder-btn').innerText = '收起';
				}
				var picPageCarxFolderExpdate = new Date(); //初始化时间
				picPageCarxFolderExpdate.setTime(picPageCarxFolderExpdate.getTime() + 1000 * 60 * 60 * 24 * 182); //一年有效
				document.querySelector('.carx-folder-btn').onclick = function() {
					if (this.innerText == '收起') {
						document.cookie = 'picPageCarxFolder=1;expires=' + picPageCarxFolderExpdate.toGMTString() + ';path=/';
						document.querySelector('.car-pic-index-carx-list').className = 'car-pic-index-carx-list fold';
						this.innerText = '展开';
					} else {
						document.cookie = 'picPageCarxFolder=0;expires=' + picPageCarxFolderExpdate.toGMTString() + ';path=/';
						document.querySelector('.car-pic-index-carx-list').className = 'car-pic-index-carx-list';
						this.innerText = '收起';
					}
				};
			}

		};
	};
	var OdCar = new OdCar();
	global.OdCar = OdCar;
}(window));