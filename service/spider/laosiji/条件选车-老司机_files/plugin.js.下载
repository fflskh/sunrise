if ((typeof(Worker) !== 'undefined')) {
  var selectMenuHtml = '<span>超清</span>' +
    '<ul class="select-menu" style="margin-left:-33px">' +
    '<li class="hd-button"><a href="javascript:;">高清</a></li>' +
    '<li class="sd-button"><a href="javascript:;" class="active">超清</a></li>' +
    '</ul>';

  function selectMenu(thisDom) {
    thisDom.parents("button[data-hd-indicator]").find("span").text(thisDom.text());
    thisDom.parents("ul").find('li a').removeClass('active');
    thisDom.addClass('active');
  }
  var Container1;
  var xxxxxPlayerControler = Clappr.UICorePlugin.extend({
    name: 'xxxxx-player-controler',
    bindEvents: function() {
      this.listenTo(this.core.mediaControl, Clappr.Events.MEDIACONTROL_RENDERED, this.render);
      this.listenTo(this.core.mediaControl, Clappr.Events.MEDIACONTROL_PLAYING, this.remove);
      this.listenTo(this.core.mediaControl, Clappr.Events.MEDIACONTROL_SHOW, this.containerChange);
    },
    containerChange: function() {
      Container1 = this.core.containers[0];

    },
    remove: function() {
      $(Container1.el).find('.changing').remove();
    },
    render: function() {
      var sourceHD;
      var sourceSD;
      this.core.$('.container').find('video')
      this.$el.css('font-size', '20px');
      this.$el.css('color', 'white');
      this.$el.css('background-color', 'red');
      this.$el.css('position', 'relative');
      this.core.mediaControl.$('.media-control-right-panel').find('button[data-hd-indicator]').after('<a href="javascript:;" style="text-align:center" class="media-control-button media-control-icon" data-hd-indicator>高清</a>');
      this.core.mediaControl.$('.media-control-right-panel').find('button[data-hd-indicator]').remove();
      this.core.mediaControl.$('.media-control-right-panel').find('a[data-hd-indicator]').show();
      this.core.mediaControl.$('.media-control-right-panel').find('a[data-hd-indicator]').html(selectMenuHtml);
      //this.core.mediaControl.$('.media-control-right-panel').find('button[data-hd-indicator]').find('.hd-button');
      this.core.mediaControl.$('.media-control-right-panel').find('a[data-hd-indicator]').on('click', '.sd-button', function(event) {
        sourceSD = $(this).parents(".player").find('.sd').val();
        Container1.pause();
        $(Container1.el).prepend('<div class="changing" style="position:absolute;z-index:111;background:#000;width:100%;height:100%;"></div>');
        var currentTime = Container1.getCurrentTime();
        $(Container1.el).find('video').attr("src", sourceSD);
        setTimeout(function() {
          Container1.seek(currentTime);
        }, 200)
        setTimeout(function() {
          Container1.play();
        }, 300)

        $(this).parent("ul").find('li a').removeClass('active');
        $(this).find('a').addClass('active');
        $(this).parents('a[data-hd-indicator]').find('span').text('超清');
      });
      this.core.mediaControl.$('.media-control-right-panel').find('a[data-hd-indicator]').on('click', '.hd-button', function(event) {
        sourceHD = $(this).parents(".player").find('.hd').val();
        Container1.pause();
        $(Container1.el).prepend('<div class="changing" style="position:absolute;z-index:111;background:#000;width:100%;height:100%;"></div>');
        var currentTime = Container1.getCurrentTime();
        $(Container1.el).find('video').attr("src", sourceHD);
        setTimeout(function() {
          Container1.seek(currentTime);
        }, 200)
        setTimeout(function() {
          Container1.play();
        }, 300)
        $(this).parent("ul").find('li a').removeClass('active');
        $(this).find('a').addClass('active');
        $(this).parents('a[data-hd-indicator]').find('span').text('高清');
      });
      return this;
    }
  });
  var xxxxxPlayerContainer = Clappr.UIContainerPlugin.extend({
    name: 'xxxxx-player-container',
    bindEvents: function() {
      this.listenTo(this.container, Clappr.Events.CONTAINER_READY, this.render);
      this.listenTo(this.container, Clappr.Events.PLAYER_PLAY, this.containerChange);
    },
    containerChange: function() {},
    render: function() {
      var ooo = this;
      this.container.$(".player-poster").find('.play-wrapper').html('<div style="position:absolute;width:100%;height:100%;top:0px;background:rgba(0,0,0,0.6)"><span style="position:absolute;left:50%;top:50%;margin-left:-28px;margin-top:-28px;display:inline-block;width: 47px;height: 47px;background: url(http://www.xxxxxbbs.com/images/xxxxxbbs-20.png) no-repeat -353px -186px;"></span></div>');
      this.container.setVolume(50);
      return this;
    }
  });
}